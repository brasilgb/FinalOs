import{q as T,r as g,v as H,j as s,$ as R,Y as N}from"./app-DZsoMaTB.js";import{A as W,I as G,B as J}from"./app-layout-CYF40tKU.js";import{B as y}from"./button-BHo3Qw3s.js";import{I as r}from"./input-07-mPzWW.js";import{L as o}from"./label-gCxFtIBT.js";import{T as c}from"./textarea-Cle50cjf.js";import{a as S}from"./dataSelect-DK188c1_.js";import{S as v}from"./react-select.esm-XqPn1uXo.js";import{I as K}from"./input-error-D39WzgZB.js";import{A as Q}from"./app-alert-success-DjvjQmSm.js";import{m as f,a as p}from"./mask-H7u_qhcY.js";import{h as U}from"./moment-C5S46NFB.js";import{W as X}from"./wrench-DSxoso1o.js";import{A as w}from"./arrow-left-GFjKUPUB.js";import{S as Z}from"./save-Bvjs_A-8.js";/* empty css            */import"./index-BAxzkzcB.js";import"./index-46NAKQpx.js";import"./index-D7UhaM4H.js";import"./tslib.es6-Cz-Yey_7.js";import"./x-ByIduJva.js";import"./createLucideIcon-Cqzl4XuT.js";import"./index-B9Bd7vXo.js";import"./index-CBloNzEM.js";import"./calendar-g3ExWXa8.js";import"./printer-dupCW95g.js";import"./badge-Dy5Jrqds.js";const ee=[{title:"Dashboard",href:"/"},{title:"Ordens",href:"/orders"},{title:"Editar",href:"/orders"}];function Ve({customers:C,order:a,technicals:F,equipments:q}){var b;const{flash:j,ziggy:I}=T().props,{page:x,cl:h,init:V}=I.query,[z,se]=g.useState(x),[_,ae]=g.useState(h),d=C.map(e=>({value:e.id,label:e.name})),u=F.map(e=>({value:e.id,label:e.name})),m=q.map(e=>({value:e.id,label:e.equipment})),{data:t,setData:i,patch:D,processing:E,errors:n}=H({customer_id:a==null?void 0:a.customer_id,equipment_id:a==null?void 0:a.equipment_id,model:a==null?void 0:a.model,password:a==null?void 0:a.password,defect:a==null?void 0:a.defect,state_conservation:a==null?void 0:a.state_conservation,accessories:a==null?void 0:a.accessories,budget_description:a==null?void 0:a.budget_description,budget_value:a==null?void 0:a.budget_value,services_performed:a.services_performed,parts:a.parts,parts_value:a.parts_value?a.parts_value:0,service_value:a.service_value?a.service_value:0,service_cost:a.service_cost,delivery_date:a.delivery_date,responsible_technician:a.responsible_technician,service_status:a==null?void 0:a.service_status,delivery_forecast:a==null?void 0:a.delivery_forecast,observations:a==null?void 0:a.observations}),k=async e=>{e.preventDefault(),D(route("orders.update",a.id))};g.useEffect(()=>{i(l=>({...l,budget_value:f(l==null?void 0:l.budget_value)})),i(l=>({...l,parts_value:f(l==null?void 0:l.parts_value)})),i(l=>({...l,service_value:f(l==null?void 0:l.service_value)}));const e=parseFloat(t==null?void 0:t.parts_value)+parseFloat(t==null?void 0:t.service_value);i(l=>({...l,service_cost:e.toFixed(2)})),t.service_status==8&&i(l=>({...l,delivery_date:U().format("YYYY-MM-DD HH:mm:ss")}))},[t.parts_value,t.service_value,t.budget_value,t.delivery_date,t.service_status]);const B=e=>{i("customer_id",(e==null?void 0:e.value)||"")},L=e=>{i("equipment_id",e==null?void 0:e.value)},A=e=>{i("service_status",e==null?void 0:e.value)},P=e=>{i("responsible_technician",e==null?void 0:e.value)},M=d==null?void 0:d.filter(e=>e.value==(a==null?void 0:a.customer_id)).map(e=>({value:e.value,label:e.label})),Y=m==null?void 0:m.filter(e=>e.value==(a==null?void 0:a.equipment_id)).map(e=>({value:e.value,label:e.label})),O=(b=S)==null?void 0:b.filter(e=>e.value==(a==null?void 0:a.service_status)).map(e=>({value:e.value,label:e.label})),$=u==null?void 0:u.filter(e=>e.value==(a==null?void 0:a.responsible_technician)).map(e=>({value:e.value,label:e.label}));return s.jsxs(W,{children:[j.message&&s.jsx(Q,{message:j.message}),s.jsx(R,{title:"Ordens"}),s.jsxs("div",{className:"flex items-center justify-between h-16 px-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(G,{iconNode:X,className:"w-8 h-8"}),s.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Ordens"})]}),s.jsx("div",{children:s.jsx(J,{breadcrumbs:ee})})]}),s.jsxs("div",{className:"flex items-center justify-between p-4",children:[s.jsx("div",{children:s.jsx(y,{variant:"default",asChild:!0,children:V?s.jsxs(N,{href:route("dashboard"),children:[s.jsx(w,{"h-4":!0,"w-4":!0}),s.jsx("span",{children:"Voltar"})]}):s.jsxs(N,{href:`/orders?page=${x||z}${h?"&cl="+h:_?"&cl="+_:""}`,children:[s.jsx(w,{"h-4":!0,"w-4":!0}),s.jsx("span",{children:"Voltar"})]})})}),s.jsx("div",{})]}),s.jsx("div",{className:"p-4",children:s.jsx("div",{className:"border rounded-lg p-2",children:s.jsxs("form",{onSubmit:k,className:"space-y-8",children:[s.jsxs("div",{className:"grid grid-cols-8 gap-4 mt-4",children:[s.jsxs("div",{className:"col-span-2 grid gap-2",children:[s.jsx(o,{htmlFor:"customer_id",children:"Cliente"}),s.jsx(v,{menuPosition:"fixed",defaultValue:M,options:d,onChange:B,placeholder:"Selecione o cliente",className:"shadow-xs p-0 border text-gray-700 border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 h-9",styles:{control:(e,l)=>({...e,fontSize:"14px",boxShadow:"none",border:"none",background:"transparent",paddingBottom:"2px"}),dropdownIndicator:e=>({...e}),menuList:e=>({...e,fontSize:"14px"})}}),s.jsx(K,{className:"mt-2",message:n.customer_id})]}),s.jsxs("div",{className:"col-span-2 grid gap-2",children:[s.jsx(o,{htmlFor:"equipment",children:"Equipamento"}),s.jsx(v,{menuPosition:"fixed",defaultValue:Y,options:m,onChange:L,placeholder:"Selecione o status",className:"shadow-xs p-0 border text-gray-700 border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 h-9",styles:{control:(e,l)=>({...e,fontSize:"14px",boxShadow:"none",border:"none",background:"transparent",paddingBottom:"2px"}),dropdownIndicator:e=>({...e}),menuList:e=>({...e,fontSize:"14px"})}}),n.equipment_id&&s.jsx("div",{className:"text-red-500 text-sm",children:n.equipment_id})]}),s.jsxs("div",{className:"col-span-2 grid gap-2",children:[s.jsx(o,{htmlFor:"model",children:"Modelo"}),s.jsx(r,{type:"text",id:"model",value:t.model,onChange:e=>i("model",e.target.value)}),n.model&&s.jsx("div",{className:"text-red-500 text-sm",children:n.model})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(o,{htmlFor:"password",children:"Senha"}),s.jsx(r,{type:"text",id:"password",value:t.password,onChange:e=>i("password",e.target.value)}),n.password&&s.jsx("div",{className:"text-red-500 text-sm",children:n.password})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(o,{htmlFor:"delivery_forecast",children:"Previsão de entrega"}),s.jsx(r,{type:"date",id:"delivery_forecast",value:t.delivery_forecast,onChange:e=>i("delivery_forecast",e.target.value)}),n.delivery_forecast&&s.jsx("div",{className:"text-red-500 text-sm",children:n.delivery_forecast})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(o,{htmlFor:"defect",children:"Defeito relatado"}),s.jsx(c,{id:"defect",value:t.defect,onChange:e=>i("defect",e.target.value)}),n.defect&&s.jsx("div",{className:"text-red-500 text-sm",children:n.defect})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(o,{htmlFor:"state_conservation",children:"Estado de conservação"}),s.jsx(c,{id:"state_conservation",value:t.state_conservation,onChange:e=>i("state_conservation",e.target.value)}),n.state_conservation&&s.jsx("div",{children:n.state_conservation})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(o,{htmlFor:"accessories",children:"Acessórios"}),s.jsx(c,{id:"accessories",value:t.accessories,onChange:e=>i("accessories",e.target.value)})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[s.jsxs("div",{className:"grid gap-2 col-span-2",children:[s.jsx(o,{htmlFor:"budget_description",children:"Descrição do orcamento"}),s.jsx(c,{id:"budget_description",value:t.budget_description,onChange:e=>i("budget_description",e.target.value)})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(o,{htmlFor:"budget_value",children:"Valor orçamento"}),s.jsx(r,{type:"text",id:"budget_value",value:p(t.budget_value.toString()),onChange:e=>i("budget_value",e.target.value)})]})]}),s.jsxs("div",{className:"grid grid-cols-5 gap-4 mt-4",children:[s.jsxs("div",{className:"grid gap-2 col-span-2",children:[s.jsx(o,{htmlFor:"parts",children:"Peças adicionadas"}),s.jsx(r,{type:"text",id:"parts",value:t.parts,onChange:e=>i("parts",e.target.value)})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(o,{htmlFor:"parts_value",children:"Valor das peças"}),s.jsx(r,{type:"text",id:"parts_value",value:p(t.parts_value.toString()),onChange:e=>i("parts_value",e.target.value)})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(o,{htmlFor:"service_value",children:"Valor do serviço"}),s.jsx(r,{type:"text",id:"service_value",value:p(t.service_value.toString()),onChange:e=>i("service_value",e.target.value)})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(o,{htmlFor:"service_cost",children:"Valor total"}),s.jsx(r,{type:"text",id:"service_cost",value:p(t.service_cost.toString()),onChange:e=>i("service_cost",e.target.value)})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(o,{htmlFor:"responsible_technician",children:"Técnico responsável"}),s.jsx(v,{menuPosition:"fixed",defaultValue:$,options:u,onChange:P,placeholder:"Selecione o técnico",className:"shadow-xs p-0 border text-gray-700 border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 h-9",styles:{control:(e,l)=>({...e,fontSize:"14px",boxShadow:"none",border:"none",background:"transparent",paddingBottom:"2px"}),dropdownIndicator:e=>({...e}),menuList:e=>({...e,fontSize:"14px"})}}),n.responsible_technician&&s.jsx("div",{className:"text-red-500 text-sm",children:n.responsible_technician})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(o,{htmlFor:"service_status",children:"Status orçamento"}),s.jsx(v,{menuPosition:"fixed",defaultValue:O,options:S,onChange:A,placeholder:"Selecione o status",className:"shadow-xs p-0 border text-gray-700 border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 h-9",styles:{control:(e,l)=>({...e,fontSize:"14px",boxShadow:"none",border:"none",background:"transparent",paddingBottom:"2px"}),dropdownIndicator:e=>({...e}),menuList:e=>({...e,fontSize:"14px"})}})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(o,{htmlFor:"services_performed",children:"Serviços executados"}),s.jsx(c,{id:"services_performed",value:t.services_performed,onChange:e=>i("services_performed",e.target.value)}),n.services_performed&&s.jsx("div",{className:"text-red-500 text-sm",children:n.services_performed})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(o,{htmlFor:"observations",children:"Observações"}),s.jsx(c,{id:"observations",value:t.observations,onChange:e=>i("observations",e.target.value)}),n.observations&&s.jsx("div",{className:"text-red-500 text-sm",children:n.observations})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsxs(y,{type:"submit",disabled:E,children:[s.jsx(Z,{}),"Salvar"]})})]})})})]})}export{Ve as default};
